Objective

    How to use SDWAN Manager APIs to retrieve the data w.r.t DC/DR cluster & do a health check before any DR drill is performed.

Requirements

To use this code you will need:

    Python 3.8+
    vManage user login details.

Install and Setup

    Clone the code to local machine.

git clone https://github.com/umohanty/DR-Precheck
cd DR-Precheck

    Setup Python Virtual Environment (requires Python 3.7+)

python3.8 -m venv venv
source venv/bin/activate
pip3 install -r requirements.txt

After setting the env variables, run the python script DC-DR-Precheck-v01.py using the command python3 DC-DR-Precheck-v03.py for macOS or Ubuntu env and py -3.8 DC-DR-Precheck-v03.py for windows env.

Sample Response:

(base) UMOHANTY-M-WGFX:Downloads umohanty$ python3 DC-DR-Precheck-v02.py
vManage Host (e.g., '10.65.104.116'): <DC vManage IP>
vManage Port (e.g., '8443'): <Port-number>
Username: admin
Password: 
dr_vManage Host (e.g., '10.65.104.116'):  <DR vManage IP>

Device List:
+--------------------+---------------------+-------------+---------+
| Data Center Name   | Host Name           | Device IP   | State   |
+====================+=====================+=============+=========+
| DC2                | Cluster-vManage2    | 1.1.1.2     | UP      |
+--------------------+---------------------+-------------+---------+
| DC2                | Cluster-vManage1    | 1.1.1.1     | UP      |
+--------------------+---------------------+-------------+---------+
| DC2                | Cluster-vManage5    | 1.1.1.5     | UP      |
+--------------------+---------------------+-------------+---------+
| DC2                | Cluster-vManage4    | 1.1.1.4     | UP      |
+--------------------+---------------------+-------------+---------+
| DC2                | Cluster-vManage3    | 1.1.1.3     | UP      |
+--------------------+---------------------+-------------+---------+
| DC2                | Cluster-vManage6    | 1.1.1.6     | UP      |
+--------------------+---------------------+-------------+---------+
| DC1 (Primary)      | Cluster-DR-vManage5 | 2.2.2.5     | UP      |
+--------------------+---------------------+-------------+---------+
| DC1 (Primary)      | Cluster-DR-vManage6 | 2.2.2.6     | UP      |
+--------------------+---------------------+-------------+---------+
| DC1 (Primary)      | Cluster-DR-vManage3 | 2.2.2.3     | UP      |
+--------------------+---------------------+-------------+---------+
| DC1 (Primary)      | Cluster-DR-vManage2 | 2.2.2.2     | UP      |
+--------------------+---------------------+-------------+---------+
| DC1 (Primary)      | Cluster-DR-vManage1 | 2.2.2.1     | UP      |
+--------------------+---------------------+-------------+---------+
| DC1 (Primary)      | Cluster-DR-vManage4 | 2.2.2.4     | UP      |
+--------------------+---------------------+-------------+---------+

Replication Details:
+---------------------+-------------------+---------------+----------------------+
| Last Replicated     | Export Duration   | Export Size   | Replication Status   |
+=====================+===================+===============+======================+
| 2025-01-30 21:37:39 | 08 secs           | 0.5 MB        | Success              |
+---------------------+-------------------+---------------+----------------------+

Disaster Recovery Status:
+-----------------+---------------------------+
| Management IP   | Data Center Personality   |
+=================+===========================+
| 1.1.1.1         | secondary                 |
+-----------------+---------------------------+
| 2.2.2.1         | primary                   |
+-----------------+---------------------------+

Disaster Recovery Status:
+--------------+--------------------------------------+---------------------+-------------+---------+---------------------+------------------+
|   vManage ID | UUID                                 | Host Name           | Device IP   | State   | Container Manager   | Persona          |
+==============+======================================+=====================+=============+=========+=====================+==================+
|            3 | 1158cc4d-b77d-4d96-8e68-5d41a13b57b9 | Cluster-DR-vManage4 | 2.2.2.4     | Ready   | False               | DATA             |
+--------------+--------------------------------------+---------------------+-------------+---------+---------------------+------------------+
|            4 | 80740a8c-170c-4a43-8b62-3a8d6174eafe | Cluster-DR-vManage5 | 2.2.2.5     | Ready   | False               | DATA             |
+--------------+--------------------------------------+---------------------+-------------+---------+---------------------+------------------+
|            5 | 79472af9-08df-4ed9-a241-071806c779bc | Cluster-DR-vManage6 | 2.2.2.6     | Ready   | False               | DATA             |
+--------------+--------------------------------------+---------------------+-------------+---------+---------------------+------------------+
|            0 | 3aae1488-99cb-45fe-b112-89e1f035753e | Cluster-DR-vManage1 | 2.2.2.1     | Ready   | False               | COMPUTE_AND_DATA |
+--------------+--------------------------------------+---------------------+-------------+---------+---------------------+------------------+
|            1 | 6580eb9c-bfdb-41df-8219-47fd408155ef | Cluster-DR-vManage2 | 2.2.2.2     | Ready   | False               | COMPUTE_AND_DATA |
+--------------+--------------------------------------+---------------------+-------------+---------+---------------------+------------------+
|            2 | 70aa26bd-1e36-4f00-acc8-50ef2bf1d482 | Cluster-DR-vManage3 | 2.2.2.3     | Ready   | False               | COMPUTE_AND_DATA |
+--------------+--------------------------------------+---------------------+-------------+---------+---------------------+------------------+

Disaster Recovery Status:
+--------------+--------------------------------------+------------------+-------------+---------+---------------------+------------------+
|   vManage ID | UUID                                 | Host Name        | Device IP   | State   | Container Manager   | Persona          |
+==============+======================================+==================+=============+=========+=====================+==================+
|            2 | 267cbd28-fbbe-48d2-bc59-86f0af1e8ae2 | Cluster-vManage3 | 1.1.1.3     | Ready   | False               | COMPUTE_AND_DATA |
+--------------+--------------------------------------+------------------+-------------+---------+---------------------+------------------+
|            5 | 0762e5c6-01b9-46ad-92ce-a180940a52f3 | Cluster-vManage6 | 1.1.1.6     | Ready   | False               | DATA             |
+--------------+--------------------------------------+------------------+-------------+---------+---------------------+------------------+
|            4 | 65a6f926-173a-4a39-9498-c71dda6d6b51 | Cluster-vManage5 | 1.1.1.5     | Ready   | False               | DATA             |
+--------------+--------------------------------------+------------------+-------------+---------+---------------------+------------------+
|            3 | 5561497c-9cad-429e-b37b-78d1327d41da | Cluster-vManage4 | 1.1.1.4     | Ready   | False               | DATA             |
+--------------+--------------------------------------+------------------+-------------+---------+---------------------+------------------+
|            0 | c2a61626-1690-4ff9-b659-fc8436a7755b | Cluster-vManage1 | 1.1.1.1     | Ready   | False               | COMPUTE_AND_DATA |
+--------------+--------------------------------------+------------------+-------------+---------+---------------------+------------------+
|            1 | f93bc490-0399-4d11-ba33-99e46a9ad98d | Cluster-vManage2 | 1.1.1.2     | Ready   | False               | COMPUTE_AND_DATA |
+--------------+--------------------------------------+------------------+-------------+---------+---------------------+------------------+

Disaster Recovery Status:
+-------------+-----------------+----------------------+--------------------+--------------------+
| Device IP   | Statistics DB   | Application Server   | Messaging Server   | Configuration DB   |
+=============+=================+======================+====================+====================+
| 2.2.2.1     | False           | False                | False              | False              |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 2.2.2.1     | True            | True                 | True               | True               |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 2.2.2.2     | True            | True                 | True               | True               |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 2.2.2.3     | True            | True                 | True               | True               |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 2.2.2.4     | True            | True                 | False              | False              |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 2.2.2.5     | True            | True                 | False              | False              |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 2.2.2.6     | True            | True                 | False              | False              |
+-------------+-----------------+----------------------+--------------------+--------------------+

Disaster Recovery Status:
+-------------+-----------------+----------------------+--------------------+--------------------+
| Device IP   | Statistics DB   | Application Server   | Messaging Server   | Configuration DB   |
+=============+=================+======================+====================+====================+
| 1.1.1.1     | False           | False                | False              | False              |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 1.1.1.1     | True            | True                 | True               | True               |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 1.1.1.2     | True            | True                 | True               | True               |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 1.1.1.3     | True            | True                 | True               | True               |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 1.1.1.4     | True            | True                 | False              | False              |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 1.1.1.5     | True            | True                 | False              | False              |
+-------------+-----------------+----------------------+--------------------+--------------------+
| 1.1.1.6     | True            | True                 | False              | False              |
+-------------+-----------------+----------------------+--------------------+--------------------+

Disaster Recovery Status:
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
|                                                        | vdevice-dataKey   | vdevice-name                             | serial-number       | vdevice-host-name   |
+========================================================+===================+==========================================+=====================+=====================+
| 192.168.88.21-16DEA96BCF940761954EA5AEE34F25735A399180 | 192.168.88.21     | 16DEA96BCF940761954EA5AEE34F25735A399180 | 2025-01-30 21:41:50 | Cluster-vbond1-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.21-1D08B5AA3D691FFF1A575472DC09A8E8327EC858 | 192.168.88.21     | 1D08B5AA3D691FFF1A575472DC09A8E8327EC858 | 2025-01-30 21:41:50 | Cluster-vbond1-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.21-202A579F58EC8E4C3EA80041D65991E672AC863D | 192.168.88.21     | 202A579F58EC8E4C3EA80041D65991E672AC863D | 2025-01-30 21:41:50 | Cluster-vbond1-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.21-23E0DB64A566001A02A9110B89C713908C85AC29 | 192.168.88.21     | 23E0DB64A566001A02A9110B89C713908C85AC29 | 2025-01-30 21:41:50 | Cluster-vbond1-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.21-42583648FA0ED3BA2C77B35A925C34933DC667D8 | 192.168.88.21     | 42583648FA0ED3BA2C77B35A925C34933DC667D8 | 2025-01-30 21:41:50 | Cluster-vbond1-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.21-4BBDD2D23476C3375DE1AF089426FCA4A006D252 | 192.168.88.21     | 4BBDD2D23476C3375DE1AF089426FCA4A006D252 | 2025-01-30 21:41:50 | Cluster-vbond1-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.21-53E76EA32245A66539EECA7AF22D52BCBCD08789 | 192.168.88.21     | 53E76EA32245A66539EECA7AF22D52BCBCD08789 | 2025-01-30 21:41:50 | Cluster-vbond1-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.21-5D83565D4734550771573D08D697B1CA77D56D50 | 192.168.88.21     | 5D83565D4734550771573D08D697B1CA77D56D50 | 2025-01-30 21:41:50 | Cluster-vbond1-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
|                                                        | vdevice-dataKey   | vdevice-name                             | serial-number       | vdevice-host-name   |
+========================================================+===================+==========================================+=====================+=====================+
| 192.168.88.23-16DEA96BCF940761954EA5AEE34F25735A399180 | 192.168.88.23     | 16DEA96BCF940761954EA5AEE34F25735A399180 | 2025-01-30 21:41:51 | Cluster-vbond1-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.23-1D08B5AA3D691FFF1A575472DC09A8E8327EC858 | 192.168.88.23     | 1D08B5AA3D691FFF1A575472DC09A8E8327EC858 | 2025-01-30 21:41:51 | Cluster-vbond1-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.23-202A579F58EC8E4C3EA80041D65991E672AC863D | 192.168.88.23     | 202A579F58EC8E4C3EA80041D65991E672AC863D | 2025-01-30 21:41:51 | Cluster-vbond1-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.23-23E0DB64A566001A02A9110B89C713908C85AC29 | 192.168.88.23     | 23E0DB64A566001A02A9110B89C713908C85AC29 | 2025-01-30 21:41:51 | Cluster-vbond1-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.23-42583648FA0ED3BA2C77B35A925C34933DC667D8 | 192.168.88.23     | 42583648FA0ED3BA2C77B35A925C34933DC667D8 | 2025-01-30 21:41:51 | Cluster-vbond1-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.23-4BBDD2D23476C3375DE1AF089426FCA4A006D252 | 192.168.88.23     | 4BBDD2D23476C3375DE1AF089426FCA4A006D252 | 2025-01-30 21:41:51 | Cluster-vbond1-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.23-53E76EA32245A66539EECA7AF22D52BCBCD08789 | 192.168.88.23     | 53E76EA32245A66539EECA7AF22D52BCBCD08789 | 2025-01-30 21:41:51 | Cluster-vbond1-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.23-5D83565D4734550771573D08D697B1CA77D56D50 | 192.168.88.23     | 5D83565D4734550771573D08D697B1CA77D56D50 | 2025-01-30 21:41:51 | Cluster-vbond1-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
|                                                        | vdevice-dataKey   | vdevice-name                             | serial-number       | vdevice-host-name   |
+========================================================+===================+==========================================+=====================+=====================+
| 192.168.88.22-16DEA96BCF940761954EA5AEE34F25735A399180 | 192.168.88.22     | 16DEA96BCF940761954EA5AEE34F25735A399180 | 2025-01-30 21:41:53 | Cluster-vbond2-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.22-1D08B5AA3D691FFF1A575472DC09A8E8327EC858 | 192.168.88.22     | 1D08B5AA3D691FFF1A575472DC09A8E8327EC858 | 2025-01-30 21:41:53 | Cluster-vbond2-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.22-202A579F58EC8E4C3EA80041D65991E672AC863D | 192.168.88.22     | 202A579F58EC8E4C3EA80041D65991E672AC863D | 2025-01-30 21:41:53 | Cluster-vbond2-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.22-23E0DB64A566001A02A9110B89C713908C85AC29 | 192.168.88.22     | 23E0DB64A566001A02A9110B89C713908C85AC29 | 2025-01-30 21:41:53 | Cluster-vbond2-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.22-42583648FA0ED3BA2C77B35A925C34933DC667D8 | 192.168.88.22     | 42583648FA0ED3BA2C77B35A925C34933DC667D8 | 2025-01-30 21:41:53 | Cluster-vbond2-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.22-4BBDD2D23476C3375DE1AF089426FCA4A006D252 | 192.168.88.22     | 4BBDD2D23476C3375DE1AF089426FCA4A006D252 | 2025-01-30 21:41:53 | Cluster-vbond2-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.22-53E76EA32245A66539EECA7AF22D52BCBCD08789 | 192.168.88.22     | 53E76EA32245A66539EECA7AF22D52BCBCD08789 | 2025-01-30 21:41:53 | Cluster-vbond2-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.22-5D83565D4734550771573D08D697B1CA77D56D50 | 192.168.88.22     | 5D83565D4734550771573D08D697B1CA77D56D50 | 2025-01-30 21:41:53 | Cluster-vbond2-DC   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
|                                                        | vdevice-dataKey   | vdevice-name                             | serial-number       | vdevice-host-name   |
+========================================================+===================+==========================================+=====================+=====================+
| 192.168.88.24-16DEA96BCF940761954EA5AEE34F25735A399180 | 192.168.88.24     | 16DEA96BCF940761954EA5AEE34F25735A399180 | 2025-01-30 21:41:54 | Cluster-vbond2-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.24-1D08B5AA3D691FFF1A575472DC09A8E8327EC858 | 192.168.88.24     | 1D08B5AA3D691FFF1A575472DC09A8E8327EC858 | 2025-01-30 21:41:54 | Cluster-vbond2-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.24-202A579F58EC8E4C3EA80041D65991E672AC863D | 192.168.88.24     | 202A579F58EC8E4C3EA80041D65991E672AC863D | 2025-01-30 21:41:54 | Cluster-vbond2-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.24-23E0DB64A566001A02A9110B89C713908C85AC29 | 192.168.88.24     | 23E0DB64A566001A02A9110B89C713908C85AC29 | 2025-01-30 21:41:54 | Cluster-vbond2-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.24-42583648FA0ED3BA2C77B35A925C34933DC667D8 | 192.168.88.24     | 42583648FA0ED3BA2C77B35A925C34933DC667D8 | 2025-01-30 21:41:54 | Cluster-vbond2-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.24-4BBDD2D23476C3375DE1AF089426FCA4A006D252 | 192.168.88.24     | 4BBDD2D23476C3375DE1AF089426FCA4A006D252 | 2025-01-30 21:41:54 | Cluster-vbond2-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.24-53E76EA32245A66539EECA7AF22D52BCBCD08789 | 192.168.88.24     | 53E76EA32245A66539EECA7AF22D52BCBCD08789 | 2025-01-30 21:41:54 | Cluster-vbond2-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
| 192.168.88.24-5D83565D4734550771573D08D697B1CA77D56D50 | 192.168.88.24     | 5D83565D4734550771573D08D697B1CA77D56D50 | 2025-01-30 21:41:54 | Cluster-vbond2-DR   |
+--------------------------------------------------------+-------------------+------------------------------------------+---------------------+---------------------+
vBond Check 0 Passed
vBond Check 1 Passed
vBond Check 2 Passed
vBond Check 3 Passed

Send to Controller :
Task Successful
{'id': '82c9bb59-c19d-4e41-b61e-512f8ab9e392'}
